# 행복도서관 프로젝트의 주요 기능에 관한 문서
 > 최초 작성 일자: 2024년 01월 15일 월요일 오후 14시 32분  
 > 최근 수정 일자: 2024년 02월 15일 목요일 오후 21시 29분
</br>

## 개 요
행복도서관에서 보유 중인 도서를 조회하고 사용자별로 도서를 관리할 수 있는 온라인 도서관 서비스 
</br>

## 주요 기능에 관한 설계(안)

### 1. 사용자 계정
- **기능 요약**
  - 회원가입, 로그인, 로그아웃 등 일반적인 사용자 계정 관리 기능
  - JWT 토큰 인증 방법으로 사용자 인증 실행
  - 토큰 검증 미들웨어(isLoggedIn)를 통해 사용자 권한이 필요한 기능은 API 요청 시 검증 실시
  - 이메일 인증을 통해 아이디 및 비밀번호 인증 수단과 간접적으로 무분별한 계정 생성을 제한하는 수단으로 활용
- **사용된 기술**
  - React 컴포넌트로 UI 구현
  - axios를 통해 서버와 비동기 통신
  - JWT 토큰(액세스 토큰과 리프레시 토큰)을 사용한 인증
  - HTTP Only 쿠키를 통한 보안 강화
  - Redis를 사용하여 리프레시 토큰 관리
  - nodemailer를 이용한 이메일 인증
  - 주소 API를 통해 주소 정보 입력
  - Redux을 사용하여 로그인 상태 관리
- **세부 내용**
  - 홈페이지 우측 상단의 로그인과 회원가입 링크를 클릭하여 각 입력폼으로 접근 가능
  - 회원가입 시 주소 API를 통해 주소 검색 후 자동 입력 
  - 회원 정보를 기입하고 이메일 인증 후 회원가입 가능
  - 이메일 인증 시 서버에서 해당 메일로 보안코드를 전송하며 사용자는 메일 확인 후 회원가입 폼에서 보안코드 입력하여 인증 가능
  - 로그인 성공 시 서버는 액세스 토큰과 리프레시 토큰을 HTTP Only 쿠키에 동봉하여 클라이언트에 발급하며, 리프레시 토큰의 경우 Redis에 저장하여 관리
  - 사용자 권한이 필요한 기능의 경우 API 요청 시 토큰 검증 미들웨어(isLoggedIn)를 통해 액세스 토큰 검증
  - 액세스 토큰이 만료된 경우 클라이언트는 axios 인터셉터를 통해 액세스 토큰 재발급 요청(리프레시 토큰 검증 요청) 진행
  - 서버는 리프레시 토큰이 유효한 경우 액세스 토큰과 리프레시 토큰을 재발급하며 Redis의 리프레시 토큰 정보도 함께 업데이트
  - 로그인 상태 유지를 위해 로그인 권한이 필요한 요청을 토큰 검증 미들웨어로 검증하여 클라이언트는 그 결과에 따라 로그인 상태 유지 또는 변경
  - 로그인 시 토큰 페이로드에 세션키를 함께 넣고 세션키를 DB에 저장 및 관리하여 중복 로그인 방지
  - 회원정보 페이지에서 회원정보 변경과 회원탈퇴 가능
  - 회원정보 변경 및 회원탈퇴 시 이메일 인증을 통해 본인확인 절차를 거친 후 진행 가능하도록 구현
</br>

### 2. 도서 검색
- **기능 요약**
  - 도서 검색 기능
  - 도서 검색 결과 페이지
  - 도서 상세정보 페이지
- **사용된 기술**
  - React 컴포넌트로 UI 구현
  - axios를 통해 서버와 비동기 통신
  - 구글 API를 활용하여 추가 도서 정보 가져오기
- **세부 내용**
  - 홈 화면에서 검색 대상(도서명, 저자 등)을 선택하고 검색어를 입력하여 검색 가능
  - 검색창에 텍스트 입력 시 검색창 하단에 현재 입력된 텍스트와 관련된 추천검색어 최대 10개 표시
  - 추천검색어 텍스트 중 일치하는 텍스트는 하이라이트 표시
  - 검색 결과 페이지는 도서 데이터를 10개씩 보여주며, 하단의 '더 보기' 버튼 클릭 시 추가로 다음 10개 데이터를 보여주도록 구현
  - 각 도서의 정보는 서버 DB에 있는 데이터에 더해 구글 API로부터 가져온 정보를 함께 보여주기
  - 검색 결과 페이지에 나열된 도서들 중 특정 도서 정보 클릭 시 도서 상세정보 페이지로 이동
  - 도서 상세정보 페이지에서는 한 도서에 관한 더 상세한 정보를 보여주기 
</br>

### 3. 실시간 검색어
- **기능 요약**
  - 특정 기간 동안 최다 검색어 10개 실시간으로 표시
- **사용된 기술**
  - Socket.io을 사용해 실시간 웹소켓 통신 구현
  - Redis를 사용해 만료기한이 설정된 검색어 데이터 저장
  - 슬라이드쇼(Carousel) 구현
- **세부 내용**
  - Redis에 검색된 검색어를 저장하며 만료기한을 24시간으로 설정
  - Redis 데이터베이스에 검색어가 포함된 key값과 검색 빈도수가 반영된 value값 형태로 저장
  - 기존 검색어는 빈도수를 증가시키고 신규 검색어는 데이터베이스에 추가
  - 접두어를 사용하여 리프레시 토큰 데이터와 구분
  - 클라이언트는 실시간 검색어 상위 10개를 하나씩 사용자에게 보여주며 자동으로 다음 검색어를 보여주도록 슬라이드 쇼 구현
  - 서버는 1분마다 업데이트 된 상위 검색어 10개 목록을 클라이언트에게 전송
</br>

### 4. 도서 관리 및 평가
- **기능 요약**
  - 도서 '좋아요' 기능을 통해 사용자별 관심도서 설정 가능
  - 각 도서별 대여 현황 표시(각 도서는 도서관에서 1권만 보유 중인 것으로 가정)
  - 사용자는 도서별로 평점과 함께 리뷰 작성 가능
- **사용된 기술**
  - React 컴포넌트로 댓글 UI 구현
  - axios를 통해 서버와 비동기 통신
  - 테이블 조인을 통해 사용자 테이블을 중심으로 다른 테이블과 관계 설정
- **세부 내용**
  - 도서 검색 결과 페이지와 도서 상세정보 페이지에서 조회되는 도서 정보에 '좋아요' UI, 대여 현황, 평균 평점 표시
  - 도서 상세정보 페이지 하단에 모든 사용자가 작성한 댓글 내용 표시
  - 본인이 작성한 댓글에는 수정 및 삭제 버튼을 통해 댓글 수정 및 삭제 가능
</br>

### 5. 내 서재(마이페이지)
- **기능 요약**
  - 사용자가 '좋아요' 설정한 도서 목록과 대여 목록 그리고 사용자가 작성한 댓글, 희망도서 신청 목록을 종합적으로 조회 및 관리 가능
- **사용된 기술**
  - React 컴포넌트로 '내 서재' 페이지 및 UI 구현
  - axios를 통해 서버와 비동기 통신
  - 테이블 조인을 통해 사용자 테이블을 중심으로 다른 테이블과 관계 설정
- **세부 내용**
  - 사용자 '좋아요' 목록에는 '좋아요' 설정한 도서의 정보를 나열
  - 대여 현황 목록에서는 각 대여 도서별 정보와 반납 기한 등 표시
  - 댓글 목록에는 도서 정보와 해당 사용자가 작성한 댓글 내용을 표시하며 댓글 수정 및 삭제 가능
</br>

### 6. 희망도서 신청
- **기능 요약**
  - 희망도서 신청 화면에서 모든 사용자가 요청한 신청글 조회 가능하도록 게시판 기능 구현 
  - 게시글 제목, 게시글 내용, 작성자 등을 검색 조건으로 하여 게시글 검색 및 조회 기능 구현
  - 사용자는 희망도서 신청 화면의 '신청하기' 버튼을 클릭하여 입력 폼으로 이동한 후 신청글 작성하여 제출
  - 사용자가 신청한 내용은 관리자에게 전달되어 검토되며 관리자는 그 결과(접수 또는 취소)를 사용자에게 통보
  - 사용자는 신청 결과 및 진행 현황을 '내 서재'에서 확인 가능
- **사용된 기술**
  - React 컴포넌트로 게시판 UI 구현
  - axios를 통해 서버와 비동기 통신
  - 페이지네이션과 데이터 CRUD를 통해 게시판 기능 구현
- **세부 내용**
  - 희망도서 신청 화면에서 모든 사용자가 요청한 신청글 조회 가능하며 페이지마다 10개씩 표시
  - 사용자는 신청 입력 폼에 도서명, 저자 등 도서를 특정할 수 있는 내용을 입력하여 작성
  - 사용자 본인이 작성한 신청글 조회 화면에서 신청글 수정 및 삭제 가능
  - 관리자는 관리자 페이지에서 사용자가 제출한 신청글을 검토 후 접수 또는 취소 결정
  - 사용자는 '내 서재'의 희망도서 신청 목록에서 신청 결과와 진행 현황을 조회 가능
  - 신청 내용이 접수된 경우, '신청 → 검토 → 주문 → 납품 → 등록작업 → 비치'의 순서로 진행현황을 표시
  - 신청 내용이 취소된 경우, 그 사유와 함께 사용자에게 결과 전달
</br>

### 7. 공지사항
- **기능 요약**
  - 관리자가 작성한 공지글을 조회할 수 있는 페이지
  - 게시글 제목, 게시글 내용 등을 검색 조건으로 하여 게시글 검색 및 조회 기능 구현
- **사용된 기술**
  - React 컴포넌트로 게시판 UI 구현
  - axios를 통해 서버와 비동기 통신
  - 페이지네이션과 데이터 CRUD를 통해 게시판 기능 구현
- **세부 내용**
  - 사용자는 게시글 조회만 가능하며 관리자는 게시글 CRUD 가능하도록 권한 설정
  - 홈 화면에 최신 공지글 일부 표시
  - 공지사항 페이지에 각 페이지마다 게시글 10개씩 나열
  - 중요 공지글의 경우 페이지에 상관없이 상단에 고정 게시
</br>

### 8. 신착도서 및 추천도서
- **기능 요약**
  - 홈 화면에서 신착도서와 추천도서 각 3개씩 보여주기
  - 일정주기마다 자동으로 클라이언트에서 서버로 요청을 보내 업데이트 반영 
- **사용된 기술**
  - axios를 통해 서버와 비동기 통신
  - 구글 API를 활용하여 추가 도서 정보 가져오기
  - setInterval 함수를 사용하여 주기적으로 서버에 요청 전송
- **세부 내용**
  - 홈 화면에서 신착도서와 추천도서를 각 3개씩 표시
  - 신착도서는 도서 등록 시점을 기준으로 상위 15개 표시
  - 추천도서는 현재 대여 중이지 않은 도서 중 누적대여횟수 상위 15개 표시
  - 하단 버튼 클릭 시 다음 신착도서(추천도서) 목록을 3개씩 추가로 볼 수 있도록 하며 최대 각 15개까지 조회 가능
  - 클라이언트는 24시간을 주기로 서버로 요청을 보내 업데이트된 데이터 반영
  - 조회되는 도서 클릭 시 도서 상세정보 페이지로 이동
</br>

### 9. 관리자 페이지
- **기능 요약**
  - 관리자 계정을 생성하여 해당 계정만 관리자 페이지 접속 가능하도록 권한 부여
  - 강제 회원 탈퇴 등 사용자 계정 관리 권한 부여
  - 보유 도서 정보 등록, 수정, 삭제 권한 부여
  - 사용자 댓글, 희망도서 신청글 등 삭제 권한 부여
  - 희망도서 신청 내용 검토 및 진행현황 관리
  - 공지사항 게시글 관리
- **사용된 기술**
  - React를 통해 관리자 페이지 구현
  - axios를 통해 서버와 비동기 통신
  - JWT 토큰 검증을 통해 관리자 권한 관리
  - 데이터 CRUD를 통해 관리자 권한 데이터 관리
- **세부 내용**
  - 관리자만 접속 가능한 관리자 페이지 구현
  - 전체 사용자 목록을 조회하고 사용자 계정을 삭제 조치할 수 있도록 구현
  - 기존 도서 정보 수정 및 삭제, 신규 도서 등록 등 도서 관리 UI 구현
  - 사용자들이 작성한 리뷰, 도서 추가 요청 글을 삭제할 수 있는 UI 구현
  - 사용자가 신청한 희망도서 신청 내용을 조회할 수 있고 접수와 취소를 선택할 수 있도록 구현
  - 접수된 희망도서의 실제 진행 현황을 반영하도록 하는 UI 구현
  - 공지사항 게시글 CRUD
</br>
